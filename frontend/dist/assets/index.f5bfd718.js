var B=Object.defineProperty,F=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var I=(n,r,s)=>r in n?B(n,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[r]=s,k=(n,r)=>{for(var s in r||(r={}))W.call(r,s)&&I(n,s,r[s]);if(D)for(var s of D(r))A.call(r,s)&&I(n,s,r[s]);return n},C=(n,r)=>F(n,P(r));import{j,r as l,u as U,U as J,l as T,W as E,A as Y,R as X,a as L,b as G,B as H}from"./vendor.0ba01a2d.js";const _=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const m of t.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&d(m)}).observe(document,{childList:!0,subtree:!0});function s(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerpolicy&&(t.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?t.credentials="include":o.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function d(o){if(o.ep)return;o.ep=!0;const t=s(o);fetch(o.href,t)}};_();const e=j.exports.jsx,c=j.exports.jsxs,q=({uuid:n,socket:r,setUser:s,setMyPeer:d})=>{const[o,t]=l.exports.useState(n()),[m,u]=l.exports.useState(""),g=U();return c("form",{className:"form col-md-12 mt-5",children:[e("div",{className:"form-group",children:e("input",{type:"text",className:"form-control my-2",placeholder:"Enter your name",value:m,onChange:p=>u(p.target.value)})}),e("div",{className:"form-group border",children:c("div",{className:"input-group d-flex align-items-center jusitfy-content-center",children:[e("input",{type:"text",value:o,className:"form-control my-2 border-0",disabled:!0,placeholder:"Generate room code"}),c("div",{className:"input-group-append",children:[e("button",{className:"btn btn-primary btn-sm me-1",onClick:()=>t(n()),type:"button",children:"generate"}),e("button",{className:"btn btn-outline-danger btn-sm me-2",type:"button",children:"copy"})]})]})}),e("button",{type:"submit",onClick:p=>{p.preventDefault();const b={name:m,roomId:o,host:!0,presenter:!0};s(b),g(`/${o}`),console.log(b),r.emit("userJoined",b)},className:"mt-4 btn-primary btn-block form-control",children:"Generate Room"})]})},K=({uuid:n,socket:r,setUser:s,setMyPeer:d})=>{const[o,t]=l.exports.useState(""),[m,u]=l.exports.useState(""),g=U();return c("form",{className:"form col-md-12 mt-5",children:[e("div",{className:"form-group",children:e("input",{type:"text",className:"form-control my-2",placeholder:"Enter your name",value:m,onChange:p=>u(p.target.value)})}),e("div",{className:"form-group",children:e("input",{type:"text",className:"form-control my-2",placeholder:"Enter room code",value:o,onChange:p=>t(p.target.value)})}),e("button",{type:"submit",onClick:p=>{p.preventDefault();const b={name:m,roomId:o,host:!1,presenter:!1};s(b),g(`/${o}`),r.emit("userJoined",b)},className:"mt-4 btn-primary btn-block form-control",children:"Join Room"})]})};const z=({uuid:n,socket:r,setUser:s})=>c("div",{className:"row h-100 pt-5",children:[c("div",{className:"col-md-4 mt-5 form-box p-5 border border-primary rounded-2 mx-auto d-flex flex-column align-items-center",children:[e("h1",{className:"text-primary fw-bold",children:"Create Room"}),e(q,{uuid:n,socket:r,setUser:s})]}),c("div",{className:"col-md-4 mt-5 form-box p-5 border border-primary rounded-2 mx-auto d-flex flex-column align-items-center",children:[e("h1",{className:"text-primary fw-bold",children:"Join Room"}),e(K,{uuid:n,socket:r,setUser:s})]})]});const O=J.generator(),Q=({canvasRef:n,ctxRef:r,elements:s,setElements:d,tool:o,color:t,user:m,socket:u})=>{const[g,v]=l.exports.useState(null);if(l.exports.useEffect(()=>{u.on("whiteBoardDataResponse",f=>{v(f.imgURL)})},[]),!(m==null?void 0:m.presenter))return e("div",{className:"border border-dark border-3 h-100 w-100 overflow-hidden",children:e("img",{src:g,alt:"Real time white board image shared by presenter",style:{height:window.innerHeight*2,width:"285%"}})});const[p,b]=l.exports.useState(!1);return l.exports.useEffect(()=>{const f=n.current;f.height=window.innerHeight*2,f.width=window.innerWidth*2;const h=f.getContext("2d");h.strokeStyle=t,h.lineWidth=2,h.lineCap="round",r.current=h},[]),l.exports.useEffect(()=>{r.current.strokeStyle=t},[t]),l.exports.useLayoutEffect(()=>{if(n){const f=J.canvas(n.current);s.length>0&&r.current.clearRect(0,0,n.current.width,n.current.height),s.forEach(a=>{a.type==="rect"?f.draw(O.rectangle(a.offsetX,a.offsetY,a.width,a.height,{stroke:a.stroke,strokeWidth:5,roughness:0})):a.type==="line"?f.draw(O.line(a.offsetX,a.offsetY,a.width,a.height,{stroke:a.stroke,strokeWidth:5,roughness:0})):a.type==="pencil"&&f.linearPath(a.path,{stroke:a.stroke,strokeWidth:5,roughness:0})});const h=n.current.toDataURL();u.emit("whiteboardData",h)}},[s]),e("div",{onMouseDown:f=>{const{offsetX:h,offsetY:a}=f.nativeEvent;o==="pencil"?d(x=>[...x,{type:"pencil",offsetX:h,offsetY:a,path:[[h,a]],stroke:t}]):o==="line"?d(x=>[...x,{type:"line",offsetX:h,offsetY:a,width:h,height:a,stroke:t}]):o==="rect"&&d(x=>[...x,{type:"rect",offsetX:h,offsetY:a,width:0,height:0,stroke:t}]),b(!0)},onMouseMove:f=>{const{offsetX:h,offsetY:a}=f.nativeEvent;if(p)if(o==="pencil"){const{path:x}=s[s.length-1],y=[...x,[h,a]];d(i=>i.map((N,$)=>$===s.length-1?C(k({},N),{path:y}):N))}else o==="line"?d(x=>x.map((y,i)=>i===s.length-1?C(k({},y),{width:h,height:a}):y)):o==="rect"&&d(x=>x.map((y,i)=>i===s.length-1?C(k({},y),{width:h-y.offsetX,height:a-y.offsetY}):y))},onMouseUp:f=>{b(!1)},className:"border border-dark border-3 h-100 w-100 overflow-hidden",children:e("canvas",{ref:n})})},V=({setOpenedChatTab:n,socket:r})=>{const[s,d]=l.exports.useState([]),[o,t]=l.exports.useState("");l.exports.useEffect(()=>{r.on("messageResponse",u=>{d(g=>[...g,u])})},[]);const m=u=>{u.preventDefault(),o.trim()!==""&&(d(g=>[...g,{message:o,name:"You"}]),r.emit("message",{message:o}),t(""))};return c("div",{className:"position-fixed top-0 h-100 text-white bg-dark",style:{width:"400px",left:"0%"},children:[e("button",{type:"button",onClick:()=>n(!1),className:"btn btn-light btn-block w-100 mt-5",children:"Close"}),e("div",{className:"w-100 mt-5 p-2 border  border-1 border-white rounded-3 ",style:{height:"70%"},children:s.map((u,g)=>c("p",{className:"my-2 text-center w-100 py-2 border border-left-0 border-right-0  ",children:[u.name,": ",u.message]},g*999))}),c("form",{onSubmit:m,className:"w-100 mt-4 d-flex rounded-3 ",children:[e("input",{type:"text",placeholder:"Enter message",className:"h-100 border-0 rounded-0 py-2 px-4",style:{width:"90%"},value:o,onChange:u=>t(u.target.value)}),e("button",{type:"submit",className:"btn btn-primary rounded-0",children:"Send"})]})]})},Z=({user:n,socket:r,users:s})=>{const d=l.exports.useRef(null),o=l.exports.useRef(null),[t,m]=l.exports.useState("pencil"),[u,g]=l.exports.useState("black"),[v,p]=l.exports.useState([]),[b,R]=l.exports.useState([]),[M,S]=l.exports.useState(!1),[f,h]=l.exports.useState(!1),a=()=>{const N=d.current.getContext("2d");N.fillRect="white",N.clearRect(0,0,d.current.width,d.current.height),p([])},x=()=>{R(i=>[...i,v[v.length-1]]),p(i=>i.slice(0,i.length-1))},y=()=>{p(i=>[...i,b[b.length-1]]),R(i=>i.slice(0,i.length-1))};return c("div",{className:"row",children:[e("button",{type:"button",className:"btn btn-dark",style:{display:"block",position:"absolute",top:"5%",left:"3%",height:"40px",width:"100px"},onClick:()=>S(!0),children:"Users"}),e("button",{type:"button",className:"btn btn-primary",style:{display:"block",position:"absolute",top:"5%",left:"10%",height:"40px",width:"100px"},onClick:()=>h(!0),children:"Chats"}),M&&c("div",{className:"position-fixed top-0 h-100 text-white bg-dark",style:{width:"250px",left:"0%"},children:[e("button",{type:"button",onClick:()=>S(!1),className:"btn btn-light btn-block w-100 mt-5",children:"Close"}),e("div",{className:"w-100 mt-5 pt-5",children:s.map((i,N)=>c("p",{className:"my-2 text-center w-100 ",children:[i.name," ",n&&n.userId===i.userId]},N*999))})]}),f&&e(V,{setOpenedChatTab:h,socket:r}),c("h1",{className:"text-center py-4",children:["White Board Sharing App"," ",c("span",{className:"text-primary",children:["[Users Online : ",s.length,"]"]})]}),(n==null?void 0:n.presenter)&&c("div",{className:"col-md-10 mx-auto px-5 mb-3 d-flex align-items-center jusitfy-content-center",children:[c("div",{className:"d-flex col-md-2 justify-content-center gap-1",children:[c("div",{className:"d-flex gap-1 align-items-center",children:[e("label",{htmlFor:"pencil",children:"Pencil"}),e("input",{type:"radio",name:"tool",id:"pencil",checked:t==="pencil",value:"pencil",className:"mt-1",onChange:i=>m(i.target.value)})]}),c("div",{className:"d-flex gap-1 align-items-center",children:[e("label",{htmlFor:"line",children:"Line"}),e("input",{type:"radio",id:"line",name:"tool",value:"line",checked:t==="line",className:"mt-1",onChange:i=>m(i.target.value)})]}),c("div",{className:"d-flex  gap-1 align-items-center",children:[e("label",{htmlFor:"rect",children:"Rectangle"}),e("input",{type:"radio",name:"tool",id:"rect",checked:t==="rect",value:"rect",className:"mt-1",onChange:i=>m(i.target.value)})]})]}),e("div",{className:"col-md-3 mx-auto ",children:c("div",{className:"d-flex align-items-center justify-content-center",children:[e("label",{htmlFor:"color",children:"Select Color: "}),e("input",{type:"color",id:"color",className:"mt-1 ms-3",value:u,onChange:i=>g(i.target.value)})]})}),c("div",{className:"col-md-3 d-flex gap-2",children:[e("button",{className:"btn btn-primary mt-1",disabled:v.length===0,onClick:()=>x(),children:"Undo"}),e("button",{className:"btn btn-outline-primary mt-1",disabled:b.length<1,onClick:()=>y(),children:"Redo"})]}),e("div",{className:"col-md-2",children:e("button",{className:"btn btn-danger",onClick:a,children:"Clear Canvas"})})]}),e("div",{className:"col-md-10 mx-auto mt-4 canvas-box",children:e(Q,{canvasRef:d,ctxRef:o,elements:v,setElements:p,color:u,tool:t,user:n,socket:r})})]})},ee="https://bakendofsketch-2.onrender.com",te={"force new connection":!0,reconnectionAttempts:"Infinity",timeout:1e4,transports:["websocket"]},w=T(ee,te),oe=()=>{const[n,r]=l.exports.useState(null),[s,d]=l.exports.useState([]);return l.exports.useEffect(()=>{w.on("userIsJoined",t=>{t.success?(console.log("userJoined"),d(t.users)):console.log("userJoined error")}),w.on("allUsers",t=>{d(t)}),w.on("userJoinedMessageBroadcasted",t=>{console.log(`${t} joined the room`),E.info(`${t} joined the room`)}),w.on("userLeftMessageBroadcasted",t=>{console.log(`${t} left the room`),E.info(`${t} left the room`)})},[]),c("div",{className:"container",children:[e(Y,{}),c(X,{children:[e(L,{path:"/",element:e(z,{uuid:()=>{let t=()=>((1+Math.random())*65536|0).toString(16).substring(1);return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},socket:w,setUser:r})}),e(L,{path:"/:roomId",element:e(Z,{user:n,socket:w,users:s})})]})]})};G.render(e(H,{children:e(oe,{})}),document.getElementById("root"));
